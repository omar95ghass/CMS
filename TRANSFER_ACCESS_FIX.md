# ุฅุตูุงุญ ูุดููุฉ "ุบูุฑ ูุตุฑุญ ุจุงููุตูู" ูู ุงูุชุญููู

## ุงููุดููุฉ:
ุนูุฏ ูุญุงููุฉ ุงูุชุญูููุ ูุธูุฑ ุฎุทุฃ "ุบูุฑ ูุตุฑุญ ุจุงููุตูู" ุฑุบู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ.

## ุงูุณุจุจ:
1. **ูุดููุฉ ูู ุชุณุฌูู ุงูุฏุฎูู:** ููู `php/login.php` ูุง ูุญูุธ `role` ูู `$_SESSION`
2. **ูุดููุฉ ูู ุงูุชุญูู:** ููู `php/transfer_queue.php` ูุชุญูู ูู ูุฌูุฏ `$_SESSION['role']`
3. **ูุดููุฉ ูู ุงููุชุบูุฑุงุช:** ุงุณุชุฎุฏุงู `$queueId` ุจุนุฏ ุญุฐูู

## ุงูุญููู ุงููุทุจูุฉ:

### 1. โ ุฅุตูุงุญ ุชุณุฌูู ุงูุฏุฎูู
**ุงูููู:** `php/login.php`

**ุงููุดููุฉ:**
```php
$_SESSION['role'] = $user['role']; // ุบูุฑ ููุฌูุฏ
```

**ุงูุญู:**
```php
$_SESSION['username'] = $username;
$_SESSION['user_id'] = $user['id'];
$_SESSION['role'] = $user['role']; // ุฅุถุงูุฉ ูุฐุง ุงูุณุทุฑ
$_SESSION['windowNumber'] = $user['window_number'];
$role = $user['role'];
```

### 2. โ ุฅุตูุงุญ ูุดููุฉ queueId
**ุงูููู:** `php/transfer_queue.php`

**ุงููุดููุฉ:**
```php
$queueId = $input['queue_id'] ?? 0; // ุบูุฑ ูุณุชุฎุฏู
// ... ูุงุญูุงู
$queueId = $queueData['id']; // ุฅุนุงุฏุฉ ุชุนุฑูู
// ... ูุงุญูุงู
$stmt->bind_param('iiiisi', $queueId, ...); // ุงุณุชุฎุฏุงู $queueId ุงููุญุฐูู
```

**ุงูุญู:**
```php
// ุฅุฒุงูุฉ $queueId ูู ุงููุฏุฎูุงุช
$targetUserId = $input['target_user_id'] ?? 0;
$currentUserId = $_SESSION['user_id'];

// ุงุณุชุฎุฏุงู $queueData['id'] ูุจุงุดุฑุฉ
$stmt->bind_param('iiiisi', $queueData['id'], $newQueueId, $currentUserId, $targetUserId, $queueData['clinic'], $queueData['number']);
```

### 3. โ ุชุญุณูู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
**ุงูููู:** `php/transfer_queue.php`

**ุงูููุฏ ุงููุญุฏุซ:**
```php
// ุงูุชุญูู ูู ุชุณุฌูู ุงูุฏุฎูู
if (!isset($_SESSION['user_id']) || !isset($_SESSION['role'])) {
    echo json_encode(['status' => 'error', 'message' => 'ุบูุฑ ูุตุฑุญ ุจุงููุตูู']);
    exit();
}
```

## ููููุฉ ุงูุงุฎุชุจุงุฑ:

### 1. ุงุฎุชุจุงุฑ ุชุณุฌูู ุงูุฏุฎูู:
1. ุณุฌู ุฏุฎูู ูู counter
2. ุงูุชุญ `test_transfer.php` ููุชุฃูุฏ ูู ูุฌูุฏ `role` ูู ุงูุฌูุณุฉ
3. ุชุฃูุฏ ูู ุธููุฑ ุฌููุน ุงูุจูุงูุงุช ุงููุทููุจุฉ

### 2. ุงุฎุชุจุงุฑ ุงูุชุญููู:
1. ุณุฌู ุฏุฎูู ูู counter
2. ุฃูุดุฆ ุฏูุฑ ูู ุญุงูุฉ "waiting"
3. ุงุถุบุท ุนูู ุฒุฑ "ุชุญููู"
4. ุฃุฏุฎู ุฑูู ุงูุฏูุฑ
5. ุงุฎุชุฑ ุดุจุงู ุขุฎุฑ
6. ุงุถุบุท "ุชุญููู"
7. ุชุฃูุฏ ูู ูุฌุงุญ ุงูุนูููุฉ

### 3. ุงุฎุชุจุงุฑ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก:
1. ุฌุฑุจ ุงูุชุญููู ุจุฏูู ุชุณุฌูู ุฏุฎูู
2. ุชุฃูุฏ ูู ุธููุฑ ุฑุณุงูุฉ "ุบูุฑ ูุตุฑุญ ุจุงููุตูู"
3. ุฌุฑุจ ุงูุชุญููู ูุน ุจูุงูุงุช ุบูุฑ ุตุญูุญุฉ
4. ุชุฃูุฏ ูู ุธููุฑ ุฑุณุงุฆู ุฎุทุฃ ููุงุณุจุฉ

## ุงููููุงุช ุงููุญุฏุซุฉ:

### 1. `php/login.php`
- ุฅุถุงูุฉ `$_SESSION['role'] = $user['role'];`
- ุถูุงู ุญูุธ ุฌููุน ุงูุจูุงูุงุช ุงููุทููุจุฉ ูู ุงูุฌูุณุฉ

### 2. `php/transfer_queue.php`
- ุฅุฒุงูุฉ `$queueId` ุบูุฑ ุงููุณุชุฎุฏู ูู ุงููุฏุฎูุงุช
- ุงุณุชุฎุฏุงู `$queueData['id']` ูุจุงุดุฑุฉ ูู ุชุณุฌูู ุงูุชุญููู
- ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

### 3. `test_transfer.php` (ุฌุฏูุฏ)
- ููู ุงุฎุชุจุงุฑ ููุชุญูู ูู ุจูุงูุงุช ุงูุฌูุณุฉ
- ูุณุงุนุฏ ูู ุชุดุฎูุต ูุดุงูู ุงูุฌูุณุฉ

## ุงููุชุงุฆุฌ ุงููุชููุนุฉ:

### โ ุชุณุฌูู ุงูุฏุฎูู:
- ุญูุธ `role` ูู ุงูุฌูุณุฉ
- ุญูุธ ุฌููุน ุงูุจูุงูุงุช ุงููุทููุจุฉ
- ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก ูู ุงูุฌูุณุฉ

### โ ุงูุชุญููู:
- ุนุฏู ุธููุฑ "ุบูุฑ ูุตุฑุญ ุจุงููุตูู"
- ุนูู ุงูุชุญููู ุจุดูู ุตุญูุญ
- ุชุณุฌูู ุนูููุฉ ุงูุชุญููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก:
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ููููุฏุฉ
- ุชุชุจุน ุฃูุถู ูููุดุงูู
- ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุญุณูุฉ

---

ุชู ุฅุตูุงุญ ูุดููุฉ "ุบูุฑ ูุตุฑุญ ุจุงููุตูู" ุจูุฌุงุญ! ๐

## ููุฎุต ุงูุฅูุฌุงุฒุงุช:
- โ ุฅุตูุงุญ ุชุณุฌูู ุงูุฏุฎูู
- โ ุฅุตูุงุญ ูุดููุฉ queueId
- โ ุชุญุณูู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
- โ ุฅูุดุงุก ููู ุงุฎุชุจุงุฑ
- โ ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก